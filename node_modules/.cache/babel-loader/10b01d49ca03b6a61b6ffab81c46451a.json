{"remainingRequest":"/home/darkcrossunicorn/文档/admin/node_modules/babel-loader/lib/index.js!/home/darkcrossunicorn/文档/admin/node_modules/eslint-loader/index.js??ref--13-0!/home/darkcrossunicorn/文档/admin/src/utils/modalForm.js","dependencies":[{"path":"/home/darkcrossunicorn/文档/admin/src/utils/modalForm.js","mtime":1664694293058},{"path":"/home/darkcrossunicorn/文档/admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/darkcrossunicorn/文档/admin/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/darkcrossunicorn/文档/admin/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["// +----------------------------------------------------------------------\n// | HIGOSHOP [ HIGOSHOP助力中小企业数字化转型 ]\n// +----------------------------------------------------------------------\n// | Copyright (c) 2020~2022 https://www.higoshop.net All rights reserved.\n// +----------------------------------------------------------------------\n// | Licensed HIGOSHOP并不是自由软件，未经许可不能去掉HIGOSHOP相关版权\n// +----------------------------------------------------------------------\n// | Author: HIGOSHOP Team <higoshop@126.com>\n// +----------------------------------------------------------------------\nimport request from '@/plugins/request';\nimport Modal from './modal';\nimport Vue from 'vue';\nimport { Message, Spin, Notice } from 'iview';\nvar modalInstance;\n\nfunction getModalInstance() {\n  var render = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : undefined;\n  modalInstance = modalInstance || Modal.newInstance({\n    closable: true,\n    maskClosable: true,\n    footerHide: true,\n    render: render\n  });\n  return modalInstance;\n}\n\nfunction alert(options) {\n  var render = 'render' in options ? options.render : undefined;\n  var instance = getModalInstance(render);\n\n  options.onRemove = function () {\n    modalInstance = null;\n  };\n\n  instance.show(options);\n}\n\nexport default function (formRequestPromise) {\n  var _ref = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {\n    width: '700'\n  },\n      _ref$width = _ref.width,\n      width = _ref$width === void 0 ? '700' : _ref$width;\n\n  return new Promise(function (resolve) {\n    var msg = Message.loading({\n      content: 'Loading...',\n      duration: 0\n    });\n    formRequestPromise.then(function (_ref2) {\n      var data = _ref2.data;\n\n      if (data.status === false) {\n        msg();\n        return Notice.warning({\n          title: data.title,\n          duration: 3,\n          desc: data.info,\n          render: function render(h) {\n            return h('div', [h('a', {\n              attrs: {\n                href: 'http://www.crmeb.com'\n              }\n            }, data.info)]);\n          }\n        });\n      }\n\n      data.config = {};\n      data.config.global = {\n        upload: {\n          props: {\n            onSuccess: function onSuccess(res, file) {\n              if (res.status === 200) {\n                file.url = res.data.src;\n              } else {\n                Message.error(res.msg);\n              }\n            }\n          }\n        },\n        frame: {\n          props: {\n            closeBtn: false,\n            okBtn: false\n          }\n        }\n      };\n\n      data.config.onSubmit = function (formData, $f) {\n        $f.btn.loading(true);\n        $f.btn.disabled(true);\n        request[data.method.toLowerCase()](data.action, formData).then(function (res) {\n          modalInstance.remove();\n          Message.success(res.msg || '提交成功');\n          resolve(res);\n        }).catch(function (err) {\n          Message.error(err.msg || '提交失败');\n        }).finally(function () {\n          $f.btn.loading(false);\n          $f.btn.disabled(false);\n        });\n      };\n\n      data.config.submitBtn = false;\n      data.config.resetBtn = false;\n      if (!data.config.form) data.config.form = {}; // data.config.form.labelWidth = 100\n\n      var fApi;\n      data = Vue.observable(data);\n      alert({\n        title: data.title,\n        width: width,\n        loading: false,\n        render: function render(h) {\n          return h('div', {\n            class: 'common-form-create'\n          }, [h('formCreate', {\n            props: {\n              rule: data.rules,\n              option: data.config\n            },\n            on: {\n              mounted: function mounted($f) {\n                fApi = $f;\n                msg();\n              }\n            }\n          }), h('div', {\n            style: 'display:flex;justify-content: flex-end;'\n          }, [h('Button', {\n            class: 'common-form-button',\n            style: 'margin-right:14px',\n            props: {\n              type: 'default'\n            },\n            on: {\n              click: function click() {\n                modalInstance.remove();\n              }\n            }\n          }, ['取消']), h('Button', {\n            class: 'common-form-button',\n            props: {\n              type: 'primary'\n            },\n            on: {\n              click: function click() {\n                fApi.submit();\n              }\n            }\n          }, ['确认'])])]);\n        }\n      });\n    }).catch(function (res) {\n      Spin.hide();\n      msg();\n      Message.error(res.msg || '表单加载失败');\n    });\n  });\n}",null]}