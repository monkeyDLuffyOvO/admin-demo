{"remainingRequest":"/home/darkcrossunicorn/文档/admin/node_modules/babel-loader/lib/index.js!/home/darkcrossunicorn/文档/admin/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/darkcrossunicorn/文档/admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/darkcrossunicorn/文档/admin/node_modules/iview-loader/index.js??ref--0-2!/home/darkcrossunicorn/文档/admin/src/pages/product/productList/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/darkcrossunicorn/文档/admin/src/pages/product/productList/index.vue","mtime":1662448309000},{"path":"/home/darkcrossunicorn/文档/admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/darkcrossunicorn/文档/admin/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/darkcrossunicorn/文档/admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/darkcrossunicorn/文档/admin/node_modules/vue-loader/lib/index.js","mtime":499162500000},{"path":"/home/darkcrossunicorn/文档/admin/node_modules/iview-loader/index.js","mtime":1570440814000}],"contextDependencies":[],"result":["import _regeneratorRuntime from \"/home/darkcrossunicorn/\\u6587\\u6863/admin/node_modules/@babel/runtime/regenerator\";\n\nvar _methods;\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance\"); }\n\nfunction _iterableToArray(iter) { if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } }\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport goodsDetail from \"@/pages/kefu/pc/components/goods_detail\";\nimport stockEdit from \"../components/stockEdit.vue\";\nimport expandRow from \"./tableExpand.vue\";\nimport attribute from \"./attribute\";\nimport toExcel from \"../../../utils/Excel.js\";\nimport { mapState } from \"vuex\";\nimport taoBao from \"./taoBao\";\nimport dayjs from \"dayjs\";\nimport Setting from \"@/setting\";\nimport util from \"@/libs/util\";\nimport { staffListInfo } from \"@/api/store\";\nimport { getGoodHeade, getGoods, PostgoodsIsShow, treeListApi, productShowApi, productUnshowApi, storeProductApi, cascaderListApi, productCache, cacheDelete, setDeliveryType, productReviewApi, forcedRemovalApi } from \"@/api/product\";\nimport { getSupplierList as _getSupplierList } from \"@/api/supplier\";\nimport { erpConfig, erpProduct } from \"@/api/erp\";\nimport exportExcel from \"@/utils/newToExcel.js\";\nexport default {\n  name: \"product_productList\",\n  components: {\n    expandRow: expandRow,\n    attribute: attribute,\n    taoBao: taoBao,\n    goodsDetail: goodsDetail,\n    stockEdit: stockEdit\n  },\n  filters: {\n    timeFormat: function timeFormat(value) {\n      return dayjs(value * 1000).format(\"YYYY-MM-DD HH:mm\");\n    }\n  },\n  computed: _objectSpread({}, mapState(\"admin/layout\", [\"isMobile\"]), {}, mapState(\"admin/userLevel\", [\"categoryId\"]), {\n    labelWidth: function labelWidth() {\n      return this.isMobile ? undefined : 75;\n    },\n    labelPosition: function labelPosition() {\n      return this.isMobile ? \"top\" : \"right\";\n    }\n  }),\n  data: function data() {\n    var _this = this;\n\n    return {\n      supplierList: [],\n      header: {},\n      //请求头部信息\n      erpUrl: Setting.apiBaseURL + \"/file/upload/1\",\n      template: false,\n      modals: false,\n      modalsType: false,\n      delivery_type: [],\n      grid: {\n        xl: 7,\n        lg: 8,\n        md: 12,\n        sm: 24,\n        xs: 24\n      },\n      // 订单列表\n      orderData: {\n        page: 1,\n        limit: 10,\n        type: 6,\n        status: \"\",\n        time: \"\",\n        real_name: \"\",\n        store_id: \"\"\n      },\n      artFrom: {\n        page: 1,\n        limit: 15,\n        cate_id: \"\",\n        type: \"1\",\n        store_name: \"\",\n        excel: 0,\n        supplier_id: \"\",\n        store_id: \"\"\n      },\n      list: [],\n      tableList: [],\n      headeNum: [],\n      treeSelect: [],\n      isProductBox: false,\n      loading: false,\n      columns: [{\n        type: \"expand\",\n        width: 50,\n        render: function render(h, params) {\n          return h(expandRow, {\n            props: {\n              row: params.row\n            }\n          });\n        }\n      }, {\n        width: 60,\n        align: \"center\",\n        renderHeader: function renderHeader(h, params) {\n          return h(\"div\", {\n            class: {\n              \"select-panel\": true\n            },\n            on: {\n              mouseenter: function mouseenter(e) {\n                _this.display = \"block\";\n              },\n              mouseleave: function mouseleave(e) {\n                _this.display = \"none\";\n              }\n            }\n          }, [h(\"Checkbox\", {\n            props: {\n              value: _this.checkBox\n            },\n            on: {\n              \"on-change\": function onChange(e) {\n                _this.checkBox = e;\n\n                _this.$refs.table.selectAll(_this.checkBox);\n\n                _this.isAll = e ? 0 : -1;\n              }\n            }\n          }), h(\"div\", {\n            style: {\n              position: \"absolute\",\n              top: 0,\n              zIndex: 2,\n              display: _this.display,\n              width: \"80px\",\n              padding: \"5px\",\n              borderRadius: \"4px\",\n              backgroundColor: \"#fff\",\n              boxShadow: \"0 0px 5px rgba(0, 0, 0, 0.2)\",\n              transform: \"translateX(25%)\"\n            }\n          }, [h(\"div\", {\n            class: {\n              \"select-item\": true,\n              on: _this.isAll === 0\n            },\n            style: {\n              padding: \"1px 6px\",\n              cursor: \"pointer\",\n              height: \"50%\"\n            },\n            on: {\n              click: function click(e) {\n                if (_this.isAll === 0) {\n                  _this.isAll = -1;\n                  _this.checkBox = false;\n\n                  _this.$refs.table.selectAll(_this.checkBox);\n                } else {\n                  _this.isAll = 0;\n\n                  if (!_this.formSelection.length) {\n                    _this.checkBox = true;\n\n                    _this.$refs.table.selectAll(_this.checkBox);\n                  }\n                }\n\n                _this.display = \"none\";\n              }\n            }\n          } // \"选择当页\"\n          ), h(\"div\", {\n            class: {\n              \"select-item\": true,\n              on: _this.isAll === 1\n            },\n            style: {\n              padding: \"4px\",\n              cursor: \"pointer\"\n            },\n            on: {\n              click: function click(e) {\n                if (_this.isAll === 1) {\n                  _this.isAll = -1;\n                  _this.checkBox = false;\n                } else {\n                  _this.isAll = 1;\n                  _this.checkBox = true;\n                }\n\n                _this.$refs.table.selectAll(_this.checkBox);\n\n                _this.display = \"none\";\n              }\n            }\n          }, \"选择全部\")])]);\n        },\n        render: function render(h, params) {\n          return h(\"Checkbox\", {\n            props: {\n              value: params.row.checkBox\n            },\n            on: {\n              \"on-change\": function onChange(e) {\n                if (e) {\n                  _this.formSelection.push(params.row);\n                } else {\n                  _this.checkBox = false;\n\n                  _this.formSelection.forEach(function (item, index) {\n                    if (item.id === params.row.id) {\n                      _this.formSelection.splice(index, 1);\n                    }\n                  });\n                }\n\n                _this.ids = _this.formSelection.map(function (item) {\n                  return item.id;\n                });\n                _this.isAll = _this.formSelection.length ? 0 : -1; // this.responseData为查询出的结果数据\n                // params.row.checkBox = e;\n\n                params.row.checkBox = e;\n                _this.tableList[params.index].checkBox = e;\n              }\n            },\n            ref: \"checkbox\",\n            refInFor: true\n          });\n        }\n      }, {\n        title: \"商品ID\",\n        slot: \"id\",\n        width: 80\n      }, {\n        title: \"商品图\",\n        slot: \"image\",\n        width: 60\n      }, {\n        title: \"商品名称\",\n        slot: \"store_name\",\n        minWidth: 250\n      }, {\n        title: \"商品来源\",\n        key: \"plate_name\",\n        minWidth: 100\n      }, {\n        title: \"商品类型\",\n        slot: \"product_type\",\n        minWidth: 100\n      }, {\n        title: \"商品售价\",\n        key: \"price\",\n        minWidth: 90\n      }, {\n        title: \"销量\",\n        key: \"sales\",\n        minWidth: 90\n      }, {\n        title: \"库存\",\n        key: \"stock\",\n        minWidth: 80\n      }, {\n        title: \"排序\",\n        key: \"sort\",\n        minWidth: 70\n      }, {\n        title: \"状态\",\n        slot: \"state\",\n        width: 120\n      }, {\n        title: \"操作\",\n        slot: \"action\",\n        fixed: \"right\",\n        minWidth: 150\n      }],\n      data: [],\n      total: 0,\n      props: {\n        emitPath: false,\n        multiple: true\n      },\n      attrTemplate: false,\n      ids: [],\n      display: \"none\",\n      formSelection: [],\n      selectionCopy: [],\n      checkBox: false,\n      isAll: -1,\n      data1: [],\n      value1: [],\n      alertShow: false,\n      goodsId: \"\",\n      columns3: [],\n      openErp: false,\n      staffData: [] // activeKey:1\n\n    };\n  },\n  watch: {\n    $route: function $route() {\n      if (this.$route.fullPath === \"/admin/product/product_list?type=5\") {\n        this.getPath();\n      }\n    },\n    formSelection: function formSelection(value) {// this.checkBox = value.length === this.tableList.length;\n    },\n    tableList: {\n      deep: true,\n      handler: function handler(value) {\n        var _this2 = this;\n\n        value.forEach(function (item) {\n          _this2.formSelection.forEach(function (itm) {\n            if (itm.id === item.id) {\n              item.checkBox = true;\n            }\n          });\n        });\n        var arr = this.tableList.filter(function (item) {\n          return item.checkBox;\n        });\n\n        if (this.tableList.length) {\n          this.checkBox = this.tableList.length === arr.length;\n        } else {\n          this.checkBox = false;\n        }\n      }\n    }\n  },\n  created: function created() {\n    var _this3 = this;\n\n    // this.artFrom.type = this.$route.query.key || 1\n    // this.columns2 = [...this.columns];\n    // if (name !== '1' && name !== '2') {\n    //     this.columns2.shift({\n    //         type: 'selection',\n    //         width: 60,\n    //         align: 'center'\n    //     })\n    // }\n    this.getToken();\n    this.staffList();\n    productCache().then(function (res) {\n      var info = res.data.info;\n\n      if (!Array.isArray(info)) {\n        _this3.alertShow = true;\n      }\n    }).catch(function (err) {\n      _this3.$Message.error(err.msg);\n    });\n    this.getErpConfig();\n  },\n  mounted: function mounted() {\n    this.goodHeade();\n    this.goodsCategory();\n    this.getSupplierList();\n\n    if (this.$route.fullPath === \"/admin/product/product_list?type=5\") {\n      this.getPath();\n    } else {\n      this.getDataList();\n    } // this.getDataList();\n\n  },\n  activated: function activated() {\n    this.getDataList();\n  },\n  beforeRouteEnter: function beforeRouteEnter(to, from, next) {\n    next(function (vm) {\n      if (from.path.indexOf(\"/admin/product/add_product\") != -1) {\n        document.documentElement.scrollTop = to.meta.scollTopPosition;\n      }\n    });\n  },\n  beforeRouteLeave: function beforeRouteLeave(to, from, next) {\n    if (from.meta.keepAlive) {\n      from.meta.scollTopPosition = document.documentElement.scrollTop;\n    }\n\n    next();\n  },\n  methods: (_methods = {\n    //获取供应商列表；\n    getSupplierList: function getSupplierList() {\n      var _this4 = this;\n\n      _getSupplierList().then(\n      /*#__PURE__*/\n      function () {\n        var _ref = _asyncToGenerator(\n        /*#__PURE__*/\n        _regeneratorRuntime.mark(function _callee(res) {\n          return _regeneratorRuntime.wrap(function _callee$(_context) {\n            while (1) {\n              switch (_context.prev = _context.next) {\n                case 0:\n                  _this4.supplierList = res.data;\n\n                case 1:\n                case \"end\":\n                  return _context.stop();\n              }\n            }\n          }, _callee);\n        }));\n\n        return function (_x) {\n          return _ref.apply(this, arguments);\n        };\n      }()).catch(function (res) {\n        _this4.$Message.error(res.msg);\n      });\n    },\n    // 审核\n    auditGoods: function auditGoods(row) {\n      var _this5 = this;\n\n      this.$modalForm(productReviewApi(row.id)).then(function () {\n        _this5.getDataList();\n\n        _this5.goodHeade();\n      });\n    },\n    // 强制下架\n    forcedRemoval: function forcedRemoval(row) {\n      var _this6 = this;\n\n      console.log('强制下架');\n      this.$modalForm(forcedRemovalApi(row.id)).then(function () {\n        return _this6.getDataList();\n      });\n    },\n    frontDownload: function frontDownload() {\n      var a = document.createElement(\"a\"); //创建一个<a></a>标签\n\n      a.href = \"/statics/ERP商品导入模板.xlsx\"; // 给a标签的href属性值加上地址，注意，这里是绝对路径，不用加 点.\n\n      a.download = \"ERP商品导入模板.xlsx\"; //设置下载文件文件名，这里加上.xlsx指定文件类型，pdf文件就指定.fpd即可\n\n      a.style.display = \"none\"; // 障眼法藏起来a标签\n\n      document.body.appendChild(a); // 将a标签追加到文档对象中\n\n      a.click(); // 模拟点击了a标签，会触发a标签的href的读取，浏览器就会自动下载了\n\n      a.remove(); // 一次性的，用完就删除a标签\n    },\n    handleFormatError: function handleFormatError(file) {\n      return this.$Message.error(\"必须上传xlsx格式文件\");\n    },\n    // 上传头部token\n    getToken: function getToken() {\n      this.header[\"Authori-zation\"] = \"Bearer \" + util.cookies.get(\"token\");\n    },\n    upFile: function upFile(res) {\n      var _this7 = this;\n\n      erpProduct({\n        path: res.data.src\n      }).then(function (res) {\n        _this7.$Message.success(res.msg);\n\n        _this7.getDataList();\n      }).catch(function (err) {\n        return _this7.$Message.error(err.msg);\n      });\n    },\n    beforeUpload: function beforeUpload() {\n      var _this8 = this;\n\n      var promise = new Promise(function (resolve) {\n        _this8.$nextTick(function () {\n          resolve(true);\n        });\n      });\n      return promise;\n    },\n    //erp配置\n    getErpConfig: function getErpConfig() {\n      var _this9 = this;\n\n      erpConfig().then(function (res) {\n        _this9.openErp = res.data.open_erp;\n      }).catch(function (err) {\n        _this9.$Message.error(err.msg);\n      });\n    },\n    stockChange: function stockChange(stock) {\n      var _this10 = this;\n\n      this.tableList.forEach(function (item) {\n        if (_this10.goodsId == item.id) {\n          item.stock = stock;\n        }\n      });\n    },\n    // 库存管理\n    stockControl: function stockControl(row) {\n      this.goodsId = row.id;\n      this.$refs.stock.modals = true;\n      this.$refs.stock.productAttrs(row);\n    },\n    cancelDelivery: function cancelDelivery() {\n      this.modalsType = false;\n      this.delivery_type = []; // this.isAll = 0;\n      // this.$refs.table.selectAll(this.isAll);\n      // this.getDataList();\n    },\n    deliveryType: function deliveryType() {\n      this.modalsType = true;\n    },\n    putDelivery: function putDelivery() {\n      var _this11 = this;\n\n      if (this.delivery_type.length === 0) {\n        this.$Message.error(\"请选择要配送的商品\");\n      } else {\n        var data = {\n          all: this.isAll,\n          delivery_type: this.delivery_type\n        };\n\n        if (this.isAll === 0) {\n          data.ids = this.ids;\n        }\n\n        setDeliveryType(data).then(function (res) {\n          _this11.$Message.success(res.msg);\n\n          _this11.modalsType = false;\n          _this11.delivery_type = [];\n          _this11.isAll = 0; // this.$refs.table.selectAll(this.isAll);\n\n          _this11.getDataList();\n        }).catch(function (res) {\n          _this11.$Message.error(res.msg);\n        });\n      }\n    },\n    // 商品详情\n    lookGoods: function lookGoods(id) {\n      this.goodsId = id;\n      this.isProductBox = true;\n    },\n    closeAlert: function closeAlert() {\n      var _this12 = this;\n\n      cacheDelete().then(function (res) {\n        _this12.$Message.success(res.msg);\n      }).catch(function (err) {\n        _this12.$Message.error(err.msg);\n      });\n    },\n    selectAll: function selectAll(row) {\n      var _this13 = this;\n\n      if (row.length) {\n        this.formSelection = row;\n        this.selectionCopy = row;\n      }\n\n      this.selectionCopy.forEach(function (item, index) {\n        item.checkBox = _this13.checkBox;\n\n        _this13.$set(_this13.tableList, index, item);\n      });\n    },\n    getPath: function getPath() {\n      this.columns2 = _toConsumableArray(this.columns);\n\n      if (name !== \"1\" && name !== \"2\") {\n        this.columns2.shift();\n      }\n\n      this.artFrom.page = 1;\n      this.artFrom.type = this.$route.query.type.toString();\n      this.getDataList();\n    },\n    changeMenu: function changeMenu(row, name, index) {\n      var _this14 = this;\n\n      switch (name) {\n        case \"1\":\n          this.$router.push({\n            path: \"/admin/product/product_reply/\" + row.id\n          });\n          break;\n\n        case \"2\":\n          this.del(row, \"恢复商品\", index);\n          break;\n\n        case \"3\":\n          this.del(row, \"移入回收站\", index);\n          break;\n\n        case \"4\":\n          this.stockControl(row);\n          break;\n\n        case \"5\":\n          this.$modalForm(forcedRemovalApi(row.id)).then(function () {\n            _this14.getDataList();\n\n            _this14.goodHeade();\n          });\n          break;\n      }\n    },\n    // 数据导出；\n    exports: function () {\n      var _exports = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2() {\n        var th, filekey, data, fileName, formValidate, excelData, i, lebData;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                th = [], filekey = [], data = [], fileName = \"\";\n                formValidate = this.artFrom;\n                excelData = {};\n\n                if (this.isAll === 0) {\n                  excelData.ids = this.ids.join();\n                } else if (this.isAll === 1) {\n                  excelData.cate_id = formValidate.cate_id;\n                  excelData.type = formValidate.type;\n                  excelData.store_name = formValidate.store_name;\n                }\n\n                excelData.page = 1;\n                i = 0;\n\n              case 6:\n                if (!(i < excelData.page + 1)) {\n                  _context2.next = 23;\n                  break;\n                }\n\n                _context2.next = 9;\n                return this.getExcelData(excelData);\n\n              case 9:\n                lebData = _context2.sent;\n                if (!fileName) fileName = lebData.filename;\n\n                if (!filekey.length) {\n                  filekey = lebData.filekey;\n                }\n\n                if (!th.length) th = lebData.header;\n\n                if (!lebData.export.length) {\n                  _context2.next = 18;\n                  break;\n                }\n\n                data = data.concat(lebData.export);\n                excelData.page++;\n                _context2.next = 20;\n                break;\n\n              case 18:\n                exportExcel(th, filekey, fileName, data);\n                return _context2.abrupt(\"return\");\n\n              case 20:\n                i++;\n                _context2.next = 6;\n                break;\n\n              case 23:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function exports() {\n        return _exports.apply(this, arguments);\n      }\n\n      return exports;\n    }(),\n    getExcelData: function getExcelData(excelData) {\n      return new Promise(function (resolve, reject) {\n        storeProductApi(excelData).then(function (res) {\n          return resolve(res.data);\n        });\n      });\n    },\n    changeTemplate: function changeTemplate(e) {// this.template = e;\n    },\n    freight: function freight() {\n      this.$refs.template.isTemplate = true;\n    },\n    // 批量上架\n    onShelves: function onShelves() {\n      var _this15 = this;\n\n      if (this.ids.length === 0) {\n        this.$Message.warning(\"请选择要上架的商品\");\n      } else {\n        var data = {\n          all: this.isAll\n        };\n\n        if (this.isAll === 0) {\n          data.ids = this.ids;\n        } else if (this.isAll === 1) {\n          data.where = {\n            cate_id: this.artFrom.cate_id,\n            excel: this.artFrom.excel,\n            store_name: this.artFrom.store_name,\n            type: this.artFrom.type\n          };\n        }\n\n        productShowApi(data).then(function (res) {\n          _this15.$Message.success(res.msg);\n\n          _this15.goodHeade();\n\n          _this15.getDataList();\n        }).catch(function (res) {\n          _this15.$Message.error(res.msg);\n        });\n      }\n    },\n    // 批量下架\n    onDismount: function onDismount() {\n      var _this16 = this;\n\n      if (this.ids.length === 0) {\n        this.$Message.warning(\"请选择要下架的商品\");\n      } else {\n        var data = {\n          all: this.isAll\n        };\n\n        if (this.isAll === 0) {\n          data.ids = this.ids;\n        } else if (this.isAll === 1) {\n          data.where = {\n            cate_id: this.artFrom.cate_id,\n            excel: this.artFrom.excel,\n            store_name: this.artFrom.store_name,\n            type: this.artFrom.type\n          };\n        }\n\n        productUnshowApi(data).then(function (res) {\n          _this16.$Message.success(res.msg);\n\n          _this16.goodHeade();\n\n          _this16.getDataList();\n        }).catch(function (res) {\n          _this16.$Message.error(res.msg);\n        });\n      }\n    },\n    // 全选\n    onSelectTab: function onSelectTab(selection) {\n      this.formSelection = selection;\n      var data = [];\n      selection.map(function (item) {\n        data.push(item.id);\n      });\n      this.ids = data;\n    },\n    // 添加淘宝商品成功\n    onClose: function onClose() {\n      this.modals = false;\n    },\n    // 复制淘宝\n    onCopy: function onCopy() {\n      this.$router.push({\n        path: \"/admin/product/add_product\",\n        query: {\n          type: -1\n        }\n      }); // this.modals = true;\n    },\n    // tab选择\n    onClickTab: function onClickTab(name) {\n      this.artFrom.type = name;\n      this.columns2 = _toConsumableArray(this.columns);\n\n      if (name !== \"1\" && name !== \"2\") {\n        this.columns2.shift();\n      }\n\n      var obj = _toConsumableArray(this.columns);\n\n      obj.shift();\n      obj.splice(8, 1);\n      this.columns3 = obj;\n      this.checkBox = false;\n      this.artFrom.page = 1;\n      this.getDataList();\n    },\n    // 下拉树\n    handleCheckChange: function handleCheckChange(data) {\n      var value = \"\";\n      var title = \"\";\n      this.list = [];\n      this.artFrom.cate_id = 0;\n      data.forEach(function (item, index) {\n        value += \"\".concat(item.id, \",\");\n        title += \"\".concat(item.title, \",\");\n      });\n      value = value.substring(0, value.length - 1);\n      title = title.substring(0, title.length - 1);\n      this.list.push({\n        value: value,\n        title: title\n      });\n      this.artFrom.cate_id = value;\n      this.getDataList();\n    },\n    // 获取商品表单头数量\n    goodHeade: function goodHeade() {\n      var _this17 = this;\n\n      var data = {\n        store_name: this.artFrom.store_name,\n        cate_id: this.artFrom.cate_id || \"\",\n        supplier_id: this.artFrom.supplier_id || \"\",\n        store_id: this.artFrom.store_id || \"\"\n      };\n      getGoodHeade(data).then(function (res) {\n        _this17.headeNum = res.data.list;\n      }).catch(function (res) {\n        _this17.$Message.error(res.msg);\n      });\n    },\n    // 商品分类；\n    goodsCategory: function goodsCategory() {\n      var _this18 = this;\n\n      // treeListApi(1).then(res => {\n      //     this.treeSelect = res.data;\n      // }).catch(res => {\n      //     this.$Message.error(res.msg);\n      // })\n      cascaderListApi(1).then(function (res) {\n        _this18.data1 = res.data;\n      }).catch(function (res) {\n        _this18.$Message.error(res.msg);\n      });\n    },\n    // 商品列表；\n    getDataList: function getDataList() {\n      var _this19 = this;\n\n      this.loading = true;\n      this.artFrom.cate_id = this.artFrom.cate_id || \"\";\n      getGoods(this.artFrom).then(function (res) {\n        var data = res.data;\n        _this19.tableList = data.list.map(function (item) {\n          if (_this19.isAll === 1) {\n            item.checkBox = true;\n          } else {\n            item.checkBox = false;\n          }\n\n          return item;\n        });\n        _this19.total = res.data.count;\n        _this19.loading = false;\n      }).catch(function (res) {\n        _this19.loading = false;\n\n        _this19.$Message.error(res.msg);\n      });\n    },\n    pageChange: function pageChange(status) {\n      this.artFrom.page = status;\n      this.getDataList();\n      this.$refs.table.clearCurrentRow();\n    },\n    cascaderSearchs: function cascaderSearchs(value, selectedData) {\n      this.artFrom.cate_id = value[value.length - 1];\n      this.userSearchs();\n    },\n    // 表格搜索\n    userSearchs: function userSearchs() {\n      this.artFrom.page = 1;\n      this.formSelection = [];\n      this.goodHeade();\n      this.getDataList();\n    },\n    // 上下架\n    changeSwitch: function changeSwitch(row) {\n      var _this20 = this;\n\n      PostgoodsIsShow(row.id, row.is_show).then(function (res) {\n        _this20.$Message.success(res.msg);\n\n        _this20.goodHeade();\n\n        _this20.getDataList();\n      }).catch(function (res) {\n        _this20.$Message.error(res.msg);\n\n        _this20.goodHeade();\n\n        _this20.getDataList();\n      });\n    },\n    // 数据导出；\n    exportData: function exportData() {\n      var th = [\"商品名称\", \"商品简介\", \"商品分类\", \"价格\", \"库存\", \"销量\", \"收藏人数\"];\n      var filterVal = [\"store_name\", \"store_info\", \"cate_name\", \"price\", \"stock\", \"sales\", \"collect\"];\n      this.where.page = \"nopage\";\n      getGoods(this.where).then(function (res) {\n        var data = res.data.map(function (v) {\n          return filterVal.map(function (k) {\n            return v[k];\n          });\n        });\n        var fileTime = Date.parse(new Date());\n        var fileName = \"商户数据_\" + fileTime,\n            fileType = \"xlsx\",\n            sheetName = \"商户数据\";\n        toExcel({\n          th: th,\n          data: data,\n          fileName: fileName,\n          fileType: fileType,\n          sheetName: sheetName\n        });\n      });\n    },\n    // 属性弹出；\n    attrTap: function attrTap() {\n      this.attrTemplate = true;\n    }\n  }, _defineProperty(_methods, \"changeTemplate\", function changeTemplate(msg) {\n    this.attrTemplate = msg;\n  }), _defineProperty(_methods, \"edit\", function edit(row) {\n    this.$router.push({\n      path: \"/admin/product/add_product/\" + row.id\n    });\n  }), _defineProperty(_methods, \"del\", function del(row, tit, num) {\n    var _this21 = this;\n\n    var delfromData = {\n      title: tit,\n      num: num,\n      url: \"product/product/\".concat(row.id),\n      method: \"DELETE\",\n      ids: \"\",\n      tips: \"确定要移入回收站吗？\"\n    };\n    this.$modalSure(delfromData).then(function (res) {\n      _this21.$Message.success(res.msg);\n\n      _this21.tableList.splice(num, 1);\n\n      _this21.goodHeade();\n    }).catch(function (res) {\n      _this21.$Message.error(res.msg);\n    });\n  }), _defineProperty(_methods, \"staffList\", function staffList() {\n    var _this22 = this;\n\n    staffListInfo().then(function (res) {\n      _this22.staffData = res.data;\n    }).catch(function (err) {\n      _this22.$Message.error(err.msg);\n    });\n  }), _methods)\n};",null]}