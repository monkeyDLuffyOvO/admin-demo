{"remainingRequest":"/home/darkcrossunicorn/文档/admin/node_modules/babel-loader/lib/index.js!/home/darkcrossunicorn/文档/admin/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/darkcrossunicorn/文档/admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/darkcrossunicorn/文档/admin/node_modules/iview-loader/index.js??ref--0-2!/home/darkcrossunicorn/文档/admin/src/pages/app/wechat/card/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/darkcrossunicorn/文档/admin/src/pages/app/wechat/card/index.vue","mtime":1658973957000},{"path":"/home/darkcrossunicorn/文档/admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/darkcrossunicorn/文档/admin/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/darkcrossunicorn/文档/admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/darkcrossunicorn/文档/admin/node_modules/vue-loader/lib/index.js","mtime":499162500000},{"path":"/home/darkcrossunicorn/文档/admin/node_modules/iview-loader/index.js","mtime":1570440814000}],"contextDependencies":[],"result":["function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { wechatCardListApi, wechatCardApi } from '@/api/app';\nimport uploadPictures from \"@/components/uploadPictures\";\nimport { mapMutations } from \"vuex\";\nexport default {\n  name: 'card',\n  components: {\n    uploadPictures: uploadPictures\n  },\n  data: function data() {\n    var checkPhone = function checkPhone(rule, value, callback) {\n      if (value === '') {\n        callback(new Error('请输入电话'));\n      } else {\n        var regPone = null;\n        var mobile = /^1(3|4|5|6|7|8|9)\\d{9}$/; //最新16手机正则\n\n        var tel = /^(0[0-9]{2,3}\\-)([2-9][0-9]{4,7})+(\\-[0-9]{1,4})?$/; //座机\n\n        var tel2 = /^400-[016789]\\d{1,3}-\\d{1,4}$/; //400电话的正则\n\n        if (value.charAt(0) == 0) {\n          // charAt查找第一个字符方法，用来判断输入的是座机还是手机号\n          regPone = tel;\n        } else if (value.charAt(0) == 4) {\n          regPone = tel2;\n        } else {\n          regPone = mobile;\n        }\n\n        if (!regPone.test(value)) {\n          return callback(new Error(\"请填写正确电话\"));\n        }\n\n        callback();\n      }\n    };\n\n    return {\n      isChoice: \"\",\n      modalPic: false,\n      logoPic: false,\n      gridBtn: {\n        xl: 4,\n        lg: 8,\n        md: 8,\n        sm: 8,\n        xs: 8\n      },\n      gridPic: {\n        xl: 6,\n        lg: 8,\n        md: 12,\n        sm: 12,\n        xs: 12\n      },\n      tableIndex: 0,\n      colorList: '',\n      colors: '',\n      colorsname: '',\n      formValidate: {\n        logo_url: '',\n        brand_name: 'CRMEB',\n        // 商户名称\n        selet: 0,\n        //卡券封面切换  0--颜色/1--图片\n        attrs: [{\n          pic: ''\n        }],\n        title: '',\n        //会员卡标题\n        prerogative: '',\n        //特权说明\n        description: '',\n        //介绍\n        service_phone: '',\n        background_pic_url: '',\n        color: '',\n        //卡卷颜色\n        custom_cell: [// {\n          // \tname: '', //入口名称\n          // \ttips: '', //引导语\n          // \turl: '' //跳转链接\n          // }\n        ],\n        center_title: '',\n        //按钮描述\n        center_url: '',\n        //跳转链接\n        center_sub_title: '',\n        //提示语\n        center: [// center_title: '', //按钮描述\n          // center_url: '', //跳转链接\n          // center_sub_title: '', //提示语\n        ]\n      },\n      ruleValidate: {\n        title: [{\n          required: true,\n          message: '会员卡名称不能为空且长度不超过9个占位符',\n          trigger: 'blur'\n        }],\n        prerogative: [{\n          required: true,\n          message: '特权说明不能为空',\n          trigger: 'blur'\n        }],\n        service_phone: [{\n          required: true,\n          validator: checkPhone,\n          trigger: \"blur\"\n        } // { pattern: /^1[3456789]\\d{9}$/, message: \"手机号码格式不正确\", trigger: \"blur\" },\n        ],\n        brand_name: [{\n          required: true,\n          message: '商户名称不能为空',\n          trigger: 'blur'\n        }],\n        center_url: [{\n          required: true,\n          message: '跳转链接不能为空',\n          trigger: 'blur'\n        }],\n        center_sub_title: [{\n          required: true,\n          message: '提示语不能为空',\n          trigger: 'blur'\n        }],\n        center_title: [{\n          required: true,\n          message: '按钮描述不能为空',\n          trigger: 'blur'\n        }]\n      },\n      pic: '',\n      selecolor: false,\n      //颜色选择框\t\n      index: 0,\n      centerstatus: true //显示按钮添加\n      // addentrance: false //自定义入口框\t\n\n    };\n  },\n  created: function created() {},\n  mounted: function mounted() {\n    var _this = this;\n\n    this.$nextTick(function () {\n      _this.getList();\n    });\n    this.setCopyrightShow({\n      value: false\n    });\n  },\n  destroyed: function destroyed() {\n    this.setCopyrightShow({\n      value: true\n    });\n  },\n  methods: _objectSpread({}, mapMutations('admin/layout', ['setCopyrightShow']), {\n    getList: function getList() {\n      var _this2 = this;\n\n      wechatCardListApi().then(function (res) {\n        _this2.colorList = res.data.color;\n        _this2.formValidate = res.data.info;\n\n        _this2.$set(_this2.formValidate, \"selet\", res.data.selet || 0);\n\n        var it = res.data.info.color || _this2.colorList[0].name;\n        _this2.colors = _this2.colorList.filter(function (item) {\n          if (it == item.name) {\n            return item.value;\n          }\n        });\n\n        if (res.data.info.center_title != \"\") {\n          _this2.center_title = false;\n        }\n\n        _this2.colorsname = _this2.colors[0].name;\n        _this2.colors = _this2.colors[0].value;\n\n        if (_this2.colors == \"\") {\n          _this2.dancolor(_this2.colorList[0]);\n        }\n\n        if (res.data.selet == 1) {\n          _this2.pic = res.data.info.background_pic_url;\n        }\n\n        if (res.data.selet == 0) {\n          _this2.pic = res.data.info.color;\n        }\n      }).catch(function (err) {\n        _this2.$Message.error(err.msg);\n      });\n    },\n    seletcolor: function seletcolor() {\n      this.selecolor = !this.selecolor;\n    },\n    dancolor: function dancolor(item) {\n      this.selecolor = false;\n      this.colors = item.value;\n      this.colorsname = item.name;\n    },\n    // 点击上传图片\n    modalPicTap: function modalPicTap(tit, index) {\n      this.modalPic = true;\n      this.isChoice = tit === \"dan\" ? \"单选\" : \"多选\";\n      this.tableIndex = index;\n    },\n    // 获取单张图片信息\n    getPic: function getPic(pc) {\n      var _this3 = this;\n\n      this.$nextTick(function () {\n        // this.formValidate.selet = 1\n        _this3.pic = pc.att_dir; // this.pic = pc.att_dir;\n\n        _this3.modalPic = false;\n      });\n    },\n    // 点击logo图片\n    logoPicTap: function logoPicTap(tit, index) {\n      this.logoPic = true;\n      this.isChoice = tit === \"dan\" ? \"单选\" : \"多选\";\n      this.tableIndex = index;\n    },\n    // 获取logo图片信息\n    getlogoPic: function getlogoPic(pc) {\n      var _this4 = this;\n\n      this.$nextTick(function () {\n        _this4.formValidate.logo_url = pc.att_dir;\n        _this4.logoPic = false;\n      });\n    },\n    color: function color(e) {\n      this.formValidate.selet = e;\n    },\n    add: function add() {\n      this.index++; // this.addentrance = true\n\n      this.formValidate.custom_cell.push({\n        name: '',\n        tips: '',\n        url: ''\n      });\n    },\n    //按钮添加\n    addcenter: function addcenter() {\n      this.centerstatus = false;\n    },\n    //按钮取消\n    cancelcenter: function cancelcenter() {\n      this.formValidate.center_title = '';\n      this.formValidate.center_sub_title = '';\n      this.formValidate.center_url = '';\n      this.centerstatus = true;\n    },\n    handleRemove: function handleRemove(index) {\n      this.formValidate.custom_cell.splice(index, 1);\n      this.index--;\n    },\n    submit: function submit() {\n      var _this5 = this;\n\n      this.$refs.formValidate.validate(function (valid) {\n        if (valid) {\n          if (_this5.formValidate.selet == 0) {\n            _this5.formValidate.color = _this5.colorsname;\n          } else {\n            _this5.formValidate.background_pic_url = _this5.pic;\n          }\n\n          wechatCardApi(_this5.formValidate).then(function (res) {\n            _this5.$Message.success(res.msg);\n\n            _this5.getList();\n          }).catch(function (err) {\n            _this5.$Message.error(err.msg);\n          });\n        } else {\n          _this5.$Message.error('请完善信息');\n        }\n      });\n    }\n  })\n};",null]}