{"remainingRequest":"/home/darkcrossunicorn/文档/admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/darkcrossunicorn/文档/admin/node_modules/iview-loader/index.js??ref--0-2!/home/darkcrossunicorn/文档/admin/src/pages/store/capital/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/darkcrossunicorn/文档/admin/src/pages/store/capital/index.vue","mtime":1658973957000},{"path":"/home/darkcrossunicorn/文档/admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/darkcrossunicorn/文档/admin/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/darkcrossunicorn/文档/admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/darkcrossunicorn/文档/admin/node_modules/vue-loader/lib/index.js","mtime":499162500000},{"path":"/home/darkcrossunicorn/文档/admin/node_modules/iview-loader/index.js","mtime":1570440814000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n\timport { mapState } from 'vuex';\n\timport {storeFinanceInfo, storeFinanceMarkApi, staffListInfo,exportTableList } from \"@/api/store\"\n\timport exportExcel from \"@/utils/newToExcel.js\";\n\timport timeOptions from \"@/utils/timeOptions\"\n\texport default {\n\t    name: 'order',\n\t    data () {\n\t\t\treturn{\n\t\t\t\tmodalmark: false,\n\t\t\t\tremarks: {\n\t\t\t\t\tmark: ''\n\t\t\t\t},\n\t\t\t\tstaff: [],\n\t\t\t\ttotal: 0,\n\t\t\t\tgrid: {\n\t\t\t\t    xl: 7,\n\t\t\t\t    lg: 7,\n\t\t\t\t    md: 12,\n\t\t\t\t    sm: 24,\n\t\t\t\t    xs: 24\n\t\t\t\t},\n\t\t\t\tloading: false,\n\t\t\t\tcolumns: [\n\t\t\t\t\t{\n\t\t\t\t\t\ttitle: '交易单号',\n\t\t\t\t\t\tkey: 'order_id',\n\t\t\t\t\t\tminWidth: 180\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\ttitle: '关联订单',\n\t\t\t\t\t\tkey: 'link_id',\n\t\t\t\t\t\tminWidth: 180\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\ttitle: '交易时间',\n\t\t\t\t\t\tkey: 'trade_time',\n\t\t\t\t\t\tminWidth: 150\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\ttitle: '交易金额',\n\t\t\t\t\t\tslot: 'number',\n\t\t\t\t\t\tminWidth: 80\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\ttitle: '交易人',\n\t\t\t\t\t\tslot: 'user_nickname',\n\t\t\t\t\t\tellipsis: true,  \n\t\t\t\t\t\tminWidth: 80\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\ttitle: '关联店员',\n\t\t\t\t\t\tkey: 'staff_name',\n\t\t\t\t\t\tminWidth: 80\n\t\t\t\t\t},\n\t\t\t\t    {\n\t\t\t\t        title: '交易类型',\n\t\t\t\t        key: 'type_name',\n\t\t\t\t        minWidth: 80\n\t\t\t\t    },\n\t\t\t\t\t{\n\t\t\t\t\t    title: '支付方式',\n\t\t\t\t\t    key: 'pay_type_name',\n\t\t\t\t\t    minWidth: 80\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\ttitle: '备注',\n\t\t\t\t\t\tkey: 'remark',\n\t\t\t\t\t\tminWidth: 120\n\t\t\t\t\t},\n\t\t\t\t    {\n\t\t\t\t        title: '操作',\n\t\t\t\t        slot: 'action',\n\t\t\t\t        fixed: 'right',\n\t\t\t\t        minWidth: 80,\n\t\t\t\t        align: 'center'\n\t\t\t\t    }\n\t\t\t\t],\n\t\t\t\torderList:[],\n\t\t\t\tformValidate: {\n\t\t\t\t  store_id: \"\",\n\t\t\t\t  keyword: \"\",\n\t\t\t\t  data: \"\",\n\t\t\t\t  page: 1,\n\t\t\t\t  limit: 20,\n\t\t\t\t},\n\t\t\t\ttimeVal: [],\n\t\t\t\toptions:timeOptions,\n\t\t\t}\n\t\t},\n\t\tcomputed: {\n\t\t  ...mapState('admin/layout', [\n\t\t  \t'isMobile'\n\t\t  ]),\n\t\t  labelWidth() {\n\t\t    return this.isMobile ? undefined : 80;\n\t\t  },\n\t\t  labelPosition() {\n\t\t    return this.isMobile ? \"top\" : \"left\";\n\t\t  },\n\t\t},\n\t    mounted () {\n\t\t\tthis.getList()\n\t\t\tthis.staffApi()\n\t\t},\n\t    methods: {\n\t\t\tgetList(){\n\t\t\t\tthis.loading = true\n\t\t\t\tstoreFinanceInfo(this.formValidate).then(res=>{\n\t\t\t\t\tthis.orderList = res.data.list\n\t\t\t\t\tthis.total = res.data.count\n\t\t\t\t\tthis.loading = false\n\t\t\t\t})\n\t\t\t},\n\t\t\tstaffApi(){\n\t\t\t\tstaffListInfo().then(res=>{\n\t\t\t\t\tthis.staff = res.data\n\t\t\t\t})\n\t\t\t},\n\t\t\tsearch(){\n\t\t\t\tthis.formValidate.page = 1\n\t\t\t\tthis.getList()\n\t\t\t},\n\t\t\treset(){\n\t\t\t\tthis.formValidate = {\n\t\t\t\t  store_id: \"\",\n\t\t\t\t  keyword: \"\",\n\t\t\t\t  data: \"\",\n\t\t\t\t  page: 1,\n\t\t\t\t  limit: 20,\n\t\t\t\t}\n\t\t\t\tthis.timeVal = [];\n\t\t\t\tthis.getList()\n\t\t\t},\n\t\t\t// 选择时间\n\t\t\tselectChange(tab) {\n\t\t\t  this.formValidate.page = 1;\n\t\t\t  this.formValidate.data = tab;\n\t\t\t  this.timeVal = [];\n\t\t\t  this.getList();\n\t\t\t},\n\t\t\t// 具体日期\n\t\t\tonchangeTime(e) {\n\t\t\t  this.timeVal = e;\n\t\t\t  this.formValidate.data = this.timeVal[0] ? this.timeVal.join(\"-\") : \"\";\n\t\t\t  this.formValidate.page = 1;\n\t\t\t  this.getList();\n\t\t\t},\n\t\t\t//分页\n\t\t\tpageChange(status) {\n\t\t\t  this.formValidate.page = status;\n\t\t\t  this.getList()\n\t\t\t},\n\t\t\tremark(e){\n\t\t\t\tthis.remarkId = e.id\n\t\t\t\tthis.modalmark = true;\n\t\t\t\tthis.remarks.mark = e.remark\n\t\t\t},\n\t\t\t//备注的提交\n\t\t\tputRemark(){\n\t\t\t\tthis.modalmark = false\n\t\t\t\tstoreFinanceMarkApi(this.remarkId,this.remarks).then(res=>{\n\t\t\t\t\tthis.$Message.success(res.msg)\n\t\t\t\t\tthis.remarks = {mark: ''}\n\t\t\t\t\tthis.modalmark = false\n\t\t\t\t\tthis.getList()\n\t\t\t\t}).catch(err=>{\n\t\t\t\t\tthis.$Message.error(err.msg)\n\t\t\t\t\tthis.modalmark = false\n\t\t\t\t})\n\t\t\t},\n\t\t\t// 取消备注按钮\n\t\t\tcancel(){\n\t\t\t\tthis.remarks = {mark: ''}\n\t\t\t\tthis.modalmark = false\n\t\t\t},\n\t\t\t//导出\n\t\t\tasync exports() {\n\t\t\t\tlet [th, filekey, data, fileName] = [[], [], [], \"\"];\n\t\t\t\tlet id = this.formValidate.store_id,\n\t\t\t\tkeyword = this.formValidate.keyword,\n\t\t\t\tdate = this.formValidate.data;\n\t\t\t\tlet lebData = await this.getExcelData(id,keyword,date); \n\t\t\t\tif (!fileName) fileName = lebData.filename;\n\t\t\t\tfilekey = lebData.filekey;\n\t\t\t\tif (!th.length) th = lebData.header; //表头\n\t\t\t\tdata = data.concat(lebData.export);\n          \t\texportExcel(th, filekey, fileName, data);\n\t\t\t},\n\t\t\tgetExcelData(id,keyword,data) {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\texportTableList(id,keyword,data).then((res) => {\n\t\t\t\t\t\treturn resolve(res.data);\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\t    },\n\t}\n",null]}