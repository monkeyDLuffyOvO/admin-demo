{"remainingRequest":"/home/darkcrossunicorn/文档/admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/darkcrossunicorn/文档/admin/node_modules/iview-loader/index.js??ref--0-2!/home/darkcrossunicorn/文档/admin/src/pages/setting/setSystem/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/darkcrossunicorn/文档/admin/src/pages/setting/setSystem/index.vue","mtime":1658973957000},{"path":"/home/darkcrossunicorn/文档/admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/darkcrossunicorn/文档/admin/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/darkcrossunicorn/文档/admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/darkcrossunicorn/文档/admin/node_modules/vue-loader/lib/index.js","mtime":499162500000},{"path":"/home/darkcrossunicorn/文档/admin/node_modules/iview-loader/index.js","mtime":1570440814000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport formCreate from '@form-create/iview'\nimport { headerListApi, dataFromApi } from '@/api/setting';\nimport request from '@/plugins/request';\nimport fromSubmit from '@/components/fromSubmit/fromSubmit.vue';\nimport util from '@/libs/util';\n\nexport default {\n    name: 'setting_setSystem',\n    components: { formCreate: formCreate.$form(),fromSubmit:fromSubmit },\n    data () {\n        return {\n            // ruleValidate: {\n            //     test_appid_selete: [\n            //         { type:'number',required: true, message: '您的姓名不能为空', trigger: 'change' }\n            //     ],\n            //     appid: [\n            //         { required: true, message: '请输入您的原始密码', trigger: 'blur' }\n            //     ]\n            // },\n            // componentsModel:[\n            //     {\n            //         title:'站点地址1',\n            //         value:0.1,\n            //         name:'inputNumber',\n            //         field:'site_url_s',\n            //         on:{\n            //             change(item){\n            //             }\n            //         }\n            //     },\n            //     {\n            //         title:'选择图片',\n            //         value:'',\n            //         name:'uploadFrame',\n            //         field:'image_url_test',\n            //         upload: {\n            //             url:'/admin/widget.images/index.html',\n            //             field:'att_dir',\n            //             maxNum:5\n            //         },\n            //         on:{\n            //             change(item){\n            //             }\n            //         }\n            //     },\n            //     {\n            //         title:'上传图片',\n            //         value:'',\n            //         name:'uploadImage',\n            //         field:'image_url',\n            //         upload:{\n            //             url:'/file/upload',\n            //             size:2048,\n            //             format:['jpg','jpeg','png','gif'],\n            //             headers:{'Authori-zation':'Bearer ' + util.cookies.get('token')},\n            //             maxNum:5\n            //         },\n            //         on:{\n            //             change(item){\n            //             }\n            //         }\n            //     },\n            //     {\n            //         title:'测试',\n            //         value:1,\n            //         name:'switch',\n            //         field:'test_appid_switch',\n            //         options:[\n            //             {trueValue:0,label:'关闭'},\n            //             {falseValue:1,label:'打开'},\n            //         ],\n            //         on:{\n            //             change(item){\n            //             }\n            //         },\n            //         //关闭打开联动组件\n            //         control:[\n            //             {\n            //                 value:1,\n            //                 componentsModel:[\n            //                     {\n            //                         title:'测试22',\n            //                         value:'',\n            //                         name:'select',\n            //                         field:'test_appid_selete_ssss',\n            //                         options:[\n            //                             {value:0,label:'关闭'},\n            //                             {value:1,label:'打开'},\n            //                         ],\n            //                         on:{\n            //                             change(item){\n            //                             }\n            //                         }\n            //                     },\n            //                 ],\n            //             },\n            //             {\n            //                 value:0,\n            //                 componentsModel:[\n            //\n            //                 ],\n            //             },\n            //         ],\n            //     },\n            //     {\n            //         title:'测试',\n            //         value:'1',\n            //         name:'select',\n            //         field:'test_appid_selete',\n            //         options:[\n            //             {value:0,label:'关闭'},\n            //             {value:1,label:'打开'},\n            //         ],\n            //         on:{\n            //             change(item){\n            //             }\n            //         }\n            //     },\n            //     {\n            //         title:'测试',\n            //         value:'1',\n            //         name:'radio',\n            //         field:'test_appid',\n            //         options:[\n            //             {value:0,label:'关闭'},\n            //             {value:1,label:'打开'},\n            //         ],\n            //         on:{\n            //             change(item){\n            //             }\n            //         }\n            //     },\n            //     {\n            //         title:'微信配置',\n            //         name:'card',\n            //         componentsModel:[\n            //             {\n            //                 title:'APPID',\n            //                 value:'',\n            //                 name:'input',\n            //                 field:'appid',\n            //                 on:{\n            //                     change(item){\n            //                     }\n            //                 }\n            //             },\n            //             {\n            //                 title:'APPstoer',\n            //                 value:'',\n            //                 name:'input',\n            //                 field:'app_stoer',\n            //                 on:{\n            //                     change(item){\n            //                     }\n            //                 }\n            //             },\n            //         ],\n            //     },\n            //     {\n            //         title:'网站设置',\n            //         name:'card',\n            //         componentsModel:[\n            //             {\n            //                 title:'站点地址',\n            //                 value:'https://www.pro.net',\n            //                 name:'input',\n            //                 field:'site_title',\n            //                 on:{\n            //                     change(item){\n            //                     }\n            //                 }\n            //             },\n            //             {\n            //                 title:'站点标题',\n            //                 value:'CRMEB',\n            //                 name:'input',\n            //                 field:'site_URL',\n            //                 on:{\n            //                     change(item){\n            //                     }\n            //                 }\n            //             },\n            //         ]\n            //     }\n            // ],\n            rules: [],\n            option: {\n                form: {\n                    labelWidth: 185\n                },\n                submitBtn: {\n                    col: {\n                        span: 3,\n                        push: 3\n                    }\n                },\n                global: {\n                    upload: {\n                        props: {\n                            onSuccess (res, file) {\n                                if (res.status === 200) {\n                                    file.url = res.data.src;\n                                } else {\n                                    this.$Message.error(res.msg);\n                                }\n                            }\n                        }\n                    },\n                    frame: {\n                        props: {\n                            closeBtn: false,\n                            okBtn: false\n                        }\n                    }\n                }\n            },\n            spinShow: false,\n            FromData: null,\n            currentTab: '',\n            headerList: [],\n            headerChildrenList: [],\n            childrenId: '',\n            title: ''\n        }\n    },\n    created () {\n        this.getAllData();\n    },\n    watch: {\n        $route (to, from) {\n            this.headerChildrenList = [];\n            this.getAllData();\n        },\n        childrenId () {\n            this.getFrom();\n        }\n    },\n    methods: {\n        childrenList () {\n            let that = this;\n            that.headerList.forEach(function (item) {\n                if (item.value.toString() === that.currentTab) {\n                    if (item.children === undefined) {\n                        that.childrenId = item.id;\n                        that.headerChildrenList = [];\n                    } else {\n                        that.headerChildrenList = item.children\n                        that.childrenId = item.children.length ? item.children[0].id.toString() : ''\n                    }\n                    // that.headerChildrenList = item.children;\n                    // that.childrenId = item.children.length ? item.children[0].id.toString() : '';\n                }\n            });\n        },\n        // 头部tab\n        getHeader () {\n            this.spinShow = true;\n            return new Promise((resolve, reject) => {\n                let tab_id = this.$route.params.tab_id;\n                let data = {\n                    type: this.$route.params.type ? this.$route.params.type : 0,\n                    pid: tab_id || 0\n                };\n                headerListApi(data).then(async res => {\n                    let config = res.data.config_tab;\n                    this.headerList = config;\n                    this.currentTab = config[0].value.toString();\n                    this.childrenList();\n                    resolve(this.currentTab);\n                    this.spinShow = false;\n                }).catch(res => {\n                    this.spinShow = false;\n                    this.$Message.error(res.msg);\n                })\n            });\n        },\n        // 表单\n        getFrom () {\n            this.spinShow = true;\n            return new Promise((resolve, reject) => {\n                let ids = '';\n                if (this.$route.params.type === '3') {\n                    ids = this.$route.params.tab_id\n                } else {\n                    if (this.childrenId) {\n                        ids = this.childrenId;\n                    } else {\n                        ids = this.currentTab;\n                    }\n                }\n                let data = {\n                    tab_id: Number(ids)\n                };\n                let logistics = 'freight/config/edit_basics', agent = 'agent/config/edit_basics',\n                    integral = 'marketing/integral_config/edit_basics', sms = 'serve/sms_config/edit_basics',\n                    config = 'setting/config/edit_basics';\n                let url = this.$route.name === 'setting_logistics' ? logistics : this.$route.name === 'setting_distributionSet'\n                    ? agent : this.$route.name === 'setting_message' ? sms : this.$route.name === 'setting_setSystem' ? config : integral;\n                dataFromApi(data, url).then(async res => {\n                    this.spinShow = false;\n                    if (res.data.status === false) {\n                        return this.$authLapse(res.data);\n                    }\n                    this.FromData = res.data;\n                    this.rules = res.data.rules;\n                    this.title = res.data.title;\n                }).catch(res => {\n                    this.spinShow = false;\n                    this.$Message.error(res.msg);\n                })\n            });\n        },\n        async getAllData () {\n            if (this.$route.params.type !== '3') {\n                await this.getHeader();\n            } else {\n                this.headerList = [];\n                this.getFrom();\n            }\n        },\n        // 选择\n        changeTab () {\n            this.childrenList();\n        },\n        // 二级选择\n        changeChildrenTab (name) {\n            this.childrenId = name;\n        },\n        // 提交表单 group\n        onSubmit (formData) {\n            request({\n                url: this.FromData.action,\n                method: this.FromData.method,\n                data: formData\n            }).then(res => {\n                this.$store.dispatch('admin/account/setPageTitle')\n                this.$Message.success(res.msg);\n            }).catch(res => {\n                this.$Message.error(res.msg);\n            });\n        }\n    }\n}\n",null]}