{"remainingRequest":"/home/darkcrossunicorn/文档/admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/darkcrossunicorn/文档/admin/node_modules/iview-loader/index.js??ref--0-2!/home/darkcrossunicorn/文档/admin/src/pages/marketing/shortVideo/comment.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/darkcrossunicorn/文档/admin/src/pages/marketing/shortVideo/comment.vue","mtime":1658973957000},{"path":"/home/darkcrossunicorn/文档/admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/darkcrossunicorn/文档/admin/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/darkcrossunicorn/文档/admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/darkcrossunicorn/文档/admin/node_modules/vue-loader/lib/index.js","mtime":499162500000},{"path":"/home/darkcrossunicorn/文档/admin/node_modules/iview-loader/index.js","mtime":1570440814000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { mapState } from \"vuex\";\nimport { videoComment, videoReply, fictitiousReply } from \"@/api/marketing\";\nimport replyList from '../../product/components/replyList.vue';\nimport timeOptions from \"@/utils/timeOptions\";\nimport { formatDate } from '@/utils/validate';\nexport default {\n    name: \"product_productEvaluate\",\n    filters: {\n        formatDate (time) {\n            if (time !== 0) {\n                let date = new Date(time * 1000);\n                return formatDate(date, 'yyyy-MM-dd hh:mm:ss');\n            }\n        }\n    },\n    components: {\n        replyList\n    },\n    data() {\n        return {\n            modals: false,\n            grid: {\n                xl: 7,\n                lg: 10,\n                md: 12,\n                sm: 12,\n                xs: 24,\n            },\n            formValidate: {\n                is_reply: \"\",\n                data: \"\",\n                keyword: \"\",\n                video_id: this.$route.query.id === undefined ? 0 : this.$route.query.id,\n                page: 1,\n                limit: 15,\n            },\n            options: timeOptions,\n            tableList: [],\n            total: 0,\n            loading: false,\n            columns: [\n                {\n                    title: \"评论ID\",\n                    key: \"id\",\n                    width: 80,\n                },\n                {\n                    title: \"视频信息\",\n                    slot: \"info\",\n                    minWidth: 250,\n                },\n                {\n                    title: \"用户名称\",\n                    key: \"nickname\",\n                    minWidth: 100,\n                },\n                {\n                    title: \"评价内容\",\n                    key: \"content\",\n                    minWidth: 150,\n                },\n                {\n                    title: \"回复内容\",\n                    slot: \"reply\",\n                    minWidth: 150,\n                },\n                {\n                    title: \"评价时间\",\n                    slot: \"add_time\",\n                    sortable: true,\n                    minWidth: 150,\n                },\n                {\n                    title: \"操作\",\n                    slot: \"action\",\n                    fixed: \"right\",\n                    minWidth: 150,\n                },\n            ],\n            timeVal: [],\n            contents: {\n                content: \"\",\n            },\n            ruleInline: {\n                content: [\n                    { required: true, message: \"请输入回复内容\", trigger: \"blur\" },\n                ],\n            },\n            rows: {},\n        };\n    },\n    computed: {\n        ...mapState(\"admin/layout\", [\"isMobile\"]),\n        labelWidth() {\n            return this.isMobile ? undefined : 96;\n        },\n        labelPosition() {\n            return this.isMobile ? \"top\" : \"right\";\n        },\n    },\n    created() {\n        this.getList();\n    },\n    methods: {\n        // 查看评论列表\n        seeReply(row){\n            this.$refs.reply.modals = true;\n            this.$refs.reply.getList(row.id);\n        },\n        // 添加虚拟评论；\n        add() {\n            this.$modalForm(fictitiousReply(this.formValidate.video_id)).then(() =>\n                this.getList()\n            );\n        },\n        oks() {\n            this.modals = true;\n            this.$refs[\"contents\"].validate((valid) => {\n                if (valid) {\n                    videoReply(this.contents, this.rows.id)\n                        .then(async (res) => {\n                            this.$Message.success(res.msg);\n                            this.modals = false;\n                            this.$refs[\"contents\"].resetFields();\n                            this.getList();\n                        })\n                        .catch((res) => {\n                            this.$Message.error(res.msg);\n                        });\n                } else {\n                    return false;\n                }\n            });\n        },\n        cancels() {\n            this.modals = false;\n            this.$refs[\"contents\"].resetFields();\n        },\n        // 删除\n        del(row, tit, num) {\n            let delfromData = {\n                title: tit,\n                num: num,\n                url: `/marketing/video/comment/${row.id}`,\n                method: \"DELETE\",\n                ids: \"\",\n            };\n            this.$modalSure(delfromData)\n                .then((res) => {\n                    this.$Message.success(res.msg);\n                    this.tableList.splice(num, 1);\n                })\n                .catch((res) => {\n                    this.$Message.error(res.msg);\n                });\n        },\n        // 回复\n        reply(row) {\n            this.modals = true;\n            this.rows = row;\n            this.contents.content = row.reply;\n        },\n        // 具体日期\n        onchangeTime(e) {\n            this.timeVal = e;\n            this.formValidate.data = this.timeVal[0] ? this.timeVal.join(\"-\") : \"\";\n            this.formValidate.page = 1;\n            this.getList();\n        },\n        // 选择时间\n        selectChange(tab) {\n            this.formValidate.data = tab;\n            this.timeVal = [];\n            this.formValidate.page = 1;\n            this.getList();\n        },\n        // 列表\n        getList() {\n            this.loading = true;\n            this.formValidate.is_reply = this.formValidate.is_reply || \"\";\n            this.formValidate.keyword = this.formValidate.keyword || \"\";\n            videoComment(this.formValidate)\n                .then(async (res) => {\n                    let data = res.data;\n                    this.tableList = data.list;\n                    this.total = res.data.count;\n                    this.loading = false;\n                })\n                .catch((res) => {\n                    this.loading = false;\n                    this.$Message.error(res.msg);\n                });\n        },\n        pageChange(index) {\n            this.formValidate.page = index;\n            this.getList();\n        },\n        // 表格搜索\n        userSearchs() {\n            this.formValidate.page = 1;\n            this.getList();\n        }\n    },\n};\n",null]}