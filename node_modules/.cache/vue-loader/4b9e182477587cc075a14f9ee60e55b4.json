{"remainingRequest":"/home/darkcrossunicorn/文档/admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/darkcrossunicorn/文档/admin/node_modules/iview-loader/index.js??ref--0-2!/home/darkcrossunicorn/文档/admin/src/pages/app/wechat/user/user.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/darkcrossunicorn/文档/admin/src/pages/app/wechat/user/user.vue","mtime":1658973957000},{"path":"/home/darkcrossunicorn/文档/admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/darkcrossunicorn/文档/admin/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/darkcrossunicorn/文档/admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/darkcrossunicorn/文档/admin/node_modules/vue-loader/lib/index.js","mtime":499162500000},{"path":"/home/darkcrossunicorn/文档/admin/node_modules/iview-loader/index.js","mtime":1570440814000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { mapState } from 'vuex';\nimport { wechatUserListtApi, tagListtApi, groupsEditApi } from '@/api/app';\nimport newsCategory from '@/components/newsCategory/index';\nimport editFrom from '@/components/from/from';\nimport sendFrom from '@/components/sendCoupons/index';\nexport default {\n    name: 'user',\n    components: {\n        newsCategory,\n        editFrom,\n        sendFrom\n    },\n    data () {\n        return {\n            tagidList: [],\n            isShowSend: true,\n            maxCols: 4,\n            scrollerHeight: '600',\n            contentTop: '130',\n            contentWidth: '98%',\n            modal13: false,\n            timeVal: [],\n            fromList: {\n                title: '选择时间',\n                custom: true,\n                fromTxt: [\n                    { text: '全部', val: '' },\n                    { text: '今天', val: 'today' },\n                    { text: '昨天', val: 'yesterday' },\n                    { text: '最近7天', val: 'lately7' },\n                    { text: '最近30天', val: 'lately30' },\n                    { text: '本月', val: 'month' },\n                    { text: '本年', val: 'year' }\n                ]\n            },\n            formValidate: {\n                limit: 15,\n                page: 1,\n                nickname: '',\n                data: '',\n                tagid_list: '',\n                sex: '',\n                groupid: 0,\n                subscribe: '',\n                export: 2\n            },\n            loading: false,\n            tabList: [],\n            total: 0,\n            value2: '',\n            grid: {\n                xl: 8,\n                lg: 8,\n                md: 8,\n                sm: 24,\n                xs: 24\n            },\n            columns4: [\n                {\n                    type: 'selection',\n                    min: 60,\n                    align: 'center'\n                },\n                {\n                    title: 'ID',\n                    key: 'uid'\n                },\n                {\n                    title: '微信用户名称',\n                    key: 'nickname'\n                },\n                {\n                    title: '头像',\n                    slot: 'headimgurl'\n                },\n                {\n                    title: '性别',\n                    slot: 'sex'\n                },\n                {\n                    title: '地区',\n                    slot: 'country'\n                },\n                {\n                    title: '是否关注公众号',\n                    slot: 'subscribe'\n                },\n                {\n                    title: '用户分组',\n                    key: 'groupid'\n                },\n                {\n                    title: '用户标签',\n                    key: 'tagid_list'\n                },\n                {\n                    title: '操作',\n                    slot: 'createModalFrame',\n                    fixed: 'right',\n                    width: 100\n                }\n            ],\n            tagList: [],\n            groupList: [],\n            FromData: null,\n            selectionList: [],\n            user_ids: ''\n        }\n    },\n    computed: {\n        ...mapState('admin/layout', [\n            'isMobile'\n        ]),\n        labelWidth () {\n            return this.isMobile ? undefined : 80;\n        },\n        labelPosition () {\n            return this.isMobile ? 'top' : 'right';\n        }\n    },\n    created () {\n        this.getListTag();\n        this.getList();\n    },\n    methods: {\n        // 操作\n        changeMenu (row, name) {\n            switch (name) {\n            case '1':\n                this.editGroup(`app/wechat/user_group/${row.openid}/edit`);\n                break;\n            case '2':\n                this.editGroup(`app/wechat/user_tag/${row.openid}/edit`);\n                break;\n            default:\n                let delfromData = {\n                    title: '同步该用户标签',\n                    url: `app/wechat/syn_tag/${row.openid}`,\n                    method: 'PUT',\n                    ids: ''\n                };\n                this.$modalSure(delfromData).then((res) => {\n                    this.$Message.success(res.msg);\n                    this.getList();\n                }).catch(res => {\n                    this.$Message.error(res.msg);\n                });\n            }\n        },\n        // 修改用户分组 标签\n        editGroup (url) {\n            groupsEditApi(url).then(async res => {\n                this.FromData = res.data;\n                this.$refs.edits.modals = true;\n            }).catch(res => {\n                this.$Message.error(res.msg);\n            })\n        },\n        // 修改成功\n        submitFail () {\n            this.getList();\n        },\n        // 同步标签\n        submitModel () {\n            this.getList();\n        },\n        // 点击发送优惠券\n        onSend () {\n            if (this.selectionList.length === 0) {\n                this.$Message.warning('请选择要发送优惠券的用户');\n            } else {\n                this.$refs.sends.modals = true;\n                this.$refs.sends.getList()\n            }\n        },\n        // 发送图文消息\n        onSendPic () {\n            if (this.selectionList.length === 0) {\n                this.$Message.warning('请选择要发送图文消息的用户');\n            } else {\n                this.modal13 = true;\n            }\n        },\n        // 全选\n        onSelectTab (selection) {\n            this.selectionList = selection;\n            let data = [];\n            this.selectionList.map((item) => {\n                data.push(item.uid)\n            });\n            this.user_ids = data.join(',');\n        },\n        // 具体日期\n        onchangeTime (e) {\n            this.timeVal = e;\n            this.formValidate.data = this.timeVal.join('-');\n            this.getList();\n        },\n        // 选择时间\n        selectChange (tab) {\n            this.formValidate.data = tab;\n            this.timeVal = [];\n            this.getList();\n        },\n        // 标签 分组\n        getListTag () {\n            let obj = {\n                id: '',\n                name: '全部'\n            }\n            tagListtApi().then(async res => {\n                let data = res.data\n                this.tagList = data.tagList;\n                this.groupList = data.groupList;\n                this.groupList.unshift(obj);\n            }).catch(res => {\n                this.loading = false;\n                this.$Message.error(res.msg);\n            })\n        },\n        // 列表\n        getList () {\n            this.loading = true;\n            this.formValidate.sex = this.formValidate.sex || '';\n            this.formValidate.subscribe = this.formValidate.subscribe || '';\n            this.formValidate.tagid_list = this.tagidList.join(',');\n            wechatUserListtApi(this.formValidate).then(async res => {\n                let data = res.data\n                this.tabList = data.list;\n                this.total = data.count;\n                this.loading = false;\n            }).catch(res => {\n                this.loading = false;\n                this.$Message.error(res.msg);\n            })\n        },\n        pageChange (index) {\n            this.formValidate.page = index;\n            this.getList();\n        },\n        // 搜索\n        userSearchs () {\n            this.getList();\n        }\n    }\n}\n",null]}