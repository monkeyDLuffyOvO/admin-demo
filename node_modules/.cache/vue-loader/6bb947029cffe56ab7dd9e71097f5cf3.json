{"remainingRequest":"/home/darkcrossunicorn/文档/admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/darkcrossunicorn/文档/admin/node_modules/iview-loader/index.js??ref--0-2!/home/darkcrossunicorn/文档/admin/src/pages/marketing/shortVideo/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/darkcrossunicorn/文档/admin/src/pages/marketing/shortVideo/index.vue","mtime":1663723634000},{"path":"/home/darkcrossunicorn/文档/admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/darkcrossunicorn/文档/admin/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/darkcrossunicorn/文档/admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/darkcrossunicorn/文档/admin/node_modules/vue-loader/lib/index.js","mtime":499162500000},{"path":"/home/darkcrossunicorn/文档/admin/node_modules/iview-loader/index.js","mtime":1570440814000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { mapState } from \"vuex\";\nimport { videoList, videoSetStatus, videoSetRecommend, videoVerify, videoTakeDown } from \"@/api/marketing\";\nimport { formatDate } from \"@/utils/validate\";\nimport timeOptions from \"@/utils/timeOptions\";\nimport videoDetails from './components/videoDetails';\nexport default {\n    name: \"index\",\n    components: {\n        videoDetails\n    },\n    filters: {\n        formatDate(time) {\n            if (time !== 0) {\n                let date = new Date(time * 1000);\n                return formatDate(date, \"yyyy-MM-dd\");\n            }\n        },\n    },\n    data() {\n        return {\n            timeVal: [],\n            tableFrom: {\n                keyword: \"\",\n                data: \"\",\n                page: 1,\n                limit: 15,\n                is_verify: \"\"\n            },\n            options:timeOptions,\n            headeNum: [\n                { type: \"\", name: \"全部\" },\n                { type: \"1\", name: \"已通过审核\" },\n                { type: \"0\", name: \"待审核\" },\n                { type: \"-1\", name: \"审核未通过\" },\n                { type: \"-2\", name: \"强制下架\" }\n            ],\n            loading: false,\n            columns1: [\n                {\n                    title: \"ID\",\n                    key: \"id\",\n                    width: 80,\n                },\n                {\n                    title: \"视频\",\n                    slot: \"image\",\n                    minWidth: 90,\n                },\n                {\n                    title: \"视频介绍\",\n                    slot: \"desc\",\n                    minWidth: 150,\n                },\n                {\n                    title: \"发布人\",\n                    key: \"type_name\",\n                    minWidth: 150,\n                },\n                {\n                    title: \"浏览数\",\n                    key: \"play_num\",\n                    minWidth: 100,\n                },\n                {\n                    title: \"评论数\",\n                    key: \"comment_num\",\n                    minWidth: 100,\n                },\n                {\n                    title: \"收藏数\",\n                    key: \"collect_num\",\n                    minWidth: 100,\n                },\n                {\n                    title: \"点赞数\",\n                    key: \"like_num\",\n                    minWidth: 80,\n                },\n                {\n                    title: \"分享数\",\n                    key: \"share_num\",\n                    minWidth: 80,\n                },\n                {\n                    title: \"关联商品\",\n                    key: \"product_num\",\n                    minWidth: 80,\n                },\n                {\n                    title: \"审核状态\",\n                    slot: \"is_verify\",\n                    minWidth: 100,\n                },\n                {\n                    title: \"是否展示\",\n                    slot: \"is_show\",\n                    minWidth: 100,\n                },\n                {\n                    title: \"是否推荐\",\n                    slot: \"is_recommend\",\n                    minWidth: 100,\n                },\n                {\n                    title: \"排序\",\n                    key: \"sort\",\n                    minWidth: 80,\n                },\n                {\n                    title: \"创建时间\",\n                    key: \"add_time\",\n                    minWidth: 150,\n                },\n                {\n                    title: \"操作\",\n                    slot: \"action\",\n                    fixed: \"right\",\n                    minWidth: 200,\n                }\n            ],\n            tableList: [],\n            grid: {\n                xl: 7,\n                lg: 10,\n                md: 12,\n                sm: 24,\n                xs: 24,\n            },\n            total: 0,\n        };\n    },\n    computed: {\n        ...mapState(\"admin/layout\", [\"isMobile\"]),\n        labelWidth() {\n            return this.isMobile ? undefined : 96;\n        },\n        labelPosition() {\n            return this.isMobile ? \"top\" : \"right\";\n        },\n    },\n    created() {\n        this.getList();\n    },\n    methods: {\n        verifyFun(row){\n            this.verify(row);\n        },\n        forceFun(row){\n            this.force(row);\n        },\n        // 操作\n        changeMenu(row, name, index) {\n            switch (name) {\n                case \"2\":\n                    this.force(row);\n                    break;\n                case \"3\":\n                    this.$router.push({ path: \"/admin/marketing/short_video/comment\",query:{'id':row.id} });\n                    break;\n                case \"4\":\n                    this.del(row, '删除视频', index);\n                    break;\n                default:\n                    break;\n            }\n        },\n        // 具体日期\n        onchangeTime(e) {\n            this.timeVal = e;\n            this.tableFrom.data = this.timeVal[0] ? this.timeVal.join(\"-\") : \"\";\n            this.tableFrom.page = 1;\n            this.getList();\n        },\n        onClickTab(type){\n            this.tableFrom.page = 1;\n            this.tableFrom.is_verify = type;\n            this.getList();\n        },\n        reset(){\n            this.tableFrom.keyword = \"\";\n            this.tableFrom.data = \"\";\n            this.timeVal = \"\";\n            this.tableFrom.page = 1;\n            this.tableFrom.is_verify = \"\";\n            this.getList();\n        },\n        verify(row){\n            let data = {\n                id: row.id\n            };\n            this.$Modal.confirm({\n                title:'温馨提示',\n                content:'是否要确定该视频审核通过？',\n                okText: '确定',\n                cancelText: '拒绝',\n                onOk: () => {\n                    data.verify = 1;\n                    videoVerify(data).then(res=>{\n                        this.$Message.success(res.msg);\n                        this.getList()\n                    }).catch(err=>{\n                        this.$Message.error(err.msg)\n                    })\n                },\n                onCancel: () => {\n                    data.verify = 2;\n                    videoVerify(data).then(res=>{\n                        this.$Message.success(res.msg);\n                        this.getList()\n                    }).catch(err=>{\n                        this.$Message.error(err.msg)\n                    })\n                }\n            });\n        },\n        seeInfo(row){\n            this.$refs.detailss.modals = true\n            this.$refs.detailss.getInfo(row.id)\n            this.$refs.detailss.activeName = \"detail\"\n        },\n        force(row){\n            this.$Modal.confirm({\n                title:'温馨提示',\n                content:'是否确定该视频强制下架？',\n                onOk: () => {\n                    videoTakeDown(row.id).then(res=>{\n                        this.$Message.success(res.msg);\n                        this.getList()\n                    }).catch(err=>{\n                        this.$message.error(err.msg)\n                    })\n                },\n                onCancel: () => {\n                    this.$Message.info('已取消');\n                }\n            });\n        },\n        // 添加\n        add() {\n            this.$router.push({ path: \"/admin/marketing/short_video/create\" });\n        },\n        // 列表\n        getList() {\n            this.loading = true;\n            this.tableFrom.is_verify = this.tableFrom.is_verify || \"\";\n            videoList(this.tableFrom)\n                .then(async (res) => {\n                    let data = res.data;\n                    this.tableList = data.list;\n                    this.total = res.data.count;\n                    this.loading = false;\n                })\n                .catch((res) => {\n                    this.loading = false;\n                    this.$Message.error(res.msg);\n                });\n        },\n        // 编辑\n        edit(row) {\n            this.$router.push({\n                path: \"/admin/marketing/short_video/create/\" + row.id\n            });\n        },\n        // 删除\n        del(row, tit, num) {\n            let delfromData = {\n                title: tit,\n                num: num,\n                url: `/marketing/video/del/${row.id}`,\n                method: \"DELETE\",\n                ids: \"\",\n            };\n            this.$modalSure(delfromData)\n                .then((res) => {\n                    this.$Message.success(res.msg);\n                    this.tableList.splice(num, 1);\n                })\n                .catch((res) => {\n                    this.$Message.error(res.msg);\n                });\n        },\n        pageChange(index) {\n            this.tableFrom.page = index;\n            this.getList();\n        },\n        // 表格搜索\n        userSearchs() {\n            this.tableFrom.page = 1;\n            this.getList();\n        },\n        // 修改是否显示\n        onchangeIsShow(row) {\n            let data = {\n                id: row.id,\n                status: row.is_show,\n            };\n            videoSetStatus(data)\n                .then(async (res) => {\n                    this.$Message.success(res.msg);\n                    this.getList()\n                })\n                .catch((res) => {\n                    this.$Message.error(res.msg);\n                });\n        },\n        // 修改是否推荐\n        onchangeIsRecommend(row){\n            let data = {\n                id: row.id,\n                recommend: row.is_recommend,\n            };\n            videoSetRecommend(data)\n                .then(async (res) => {\n                    this.$Message.success(res.msg);\n                    this.getList()\n                })\n                .catch((res) => {\n                    this.$Message.error(res.msg);\n                });\n        }\n    },\n};\n",null]}