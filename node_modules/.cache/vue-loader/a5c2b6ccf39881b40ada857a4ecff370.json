{"remainingRequest":"/home/darkcrossunicorn/文档/admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/darkcrossunicorn/文档/admin/node_modules/iview-loader/index.js??ref--0-2!/home/darkcrossunicorn/文档/admin/src/pages/product/specsAdd/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/darkcrossunicorn/文档/admin/src/pages/product/specsAdd/index.vue","mtime":1653529153000},{"path":"/home/darkcrossunicorn/文档/admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/darkcrossunicorn/文档/admin/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/darkcrossunicorn/文档/admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/darkcrossunicorn/文档/admin/node_modules/vue-loader/lib/index.js","mtime":499162500000},{"path":"/home/darkcrossunicorn/文档/admin/node_modules/iview-loader/index.js","mtime":1570440814000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { mapState, mapMutations } from \"vuex\";\nimport { productSpecs, productSpecsInfo } from \"@/api/product\";\nexport default {\n  name: \"specsAdd\",\n  data() {\n    return {\n      grid: {\n        xl: 7,\n        lg: 7,\n        md: 12,\n        sm: 24,\n        xs: 24,\n      },\n      formValidate: {\n        id: 0,\n        name: \"\",\n        sort: 0,\n        specs: [],\n      },\n      ruleValidate: {\n        name: [\n          { required: true, message: \"请输入参数模板名称\", trigger: \"blur\" },\n        ],\n      },\n      columns: [\n        {\n          title: \"参数名称\",\n          key: \"name\",\n          width: 150,\n          render: (h, params) => {\n            return h(\"div\", [\n              h(\"Input\", {\n                props: {\n                  value: params.row.name,\n                  placeholder: \"请输入参数名称\",\n                },\n                on: {\n                  \"on-change\": (e) => {\n                    params.row.name = e.target.value;\n                    this.data[params.index].name = e.target.value;\n                  },\n                },\n              }),\n            ]);\n          },\n        },\n        {\n          title: \"参数值\",\n          key: \"value\",\n          width: 300,\n          render: (h, params) => {\n            return h(\"div\", [\n              h(\"Input\", {\n                props: {\n                  value: params.row.value,\n                  placeholder: \"请输入参数值\",\n                },\n                on: {\n                  \"on-change\": (e) => {\n                    params.row.value = e.target.value;\n                    this.data[params.index].value = e.target.value;\n                  },\n                },\n              }),\n            ]);\n          },\n        },\n        {\n          title: \"排序\",\n          key: \"sort\",\n          width: 100,\n          render: (h, params) => {\n            return h(\"div\", [\n              h(\"InputNumber\", {\n                props: {\n                  value: parseInt(params.row.sort) || 0,\n                  placeholder: \"排序\",\n                  precision: 0,\n                },\n                on: {\n                  \"on-change\": (e) => {\n                    params.row.sort = e;\n                    this.data[params.index].sort = e;\n                  },\n                },\n              }),\n            ]);\n          },\n        },\n        {\n          title: \"操作\",\n          slot: \"action\",\n          minWidth: 120,\n        },\n      ],\n      data: [],\n    };\n  },\n  computed: {\n    ...mapState(\"admin/layout\", [\"isMobile\", \"menuCollapse\"]),\n    labelWidth() {\n      return this.isMobile ? undefined : 120;\n    },\n    labelPosition() {\n      return this.isMobile ? \"top\" : \"right\";\n    },\n  },\n  created() {\n    this.add();\n    this.getInfo();\n  },\n  mounted() {\n    this.setCopyrightShow({ value: false });\n  },\n  destroyed() {\n    this.setCopyrightShow({ value: true });\n  },\n  methods: {\n    ...mapMutations(\"admin/layout\", [\"setCopyrightShow\"]),\n    getInfo() {\n      productSpecsInfo(this.$route.params.id).then((res) => {\n        this.formValidate = res.data;\n        this.data = res.data.specs;\n      });\n    },\n    del(index) {\n      this.data.splice(index, 1);\n    },\n    add() {\n      let obj = { name: \"\", value: \"\", sort: 0 };\n      this.data.push(obj);\n    },\n    handleSubmit(name) {\n      this.$refs[name].validate((valid) => {\n        if (valid) {\n          this.formValidate.id = this.$route.params.id;\n          this.formValidate.specs = this.data;\n          for (let i = 0; i < this.formValidate.specs.length; i++) {\n            let data = this.formValidate.specs[i];\n            if (!data.name.trim()) {\n              return this.$Message.error(\"请输入参数名称\");\n            }\n            if (!data.value.trim()) {\n              return this.$Message.error(\"请输入参数值\");\n            }\n          }\n          productSpecs(this.formValidate)\n            .then((res) => {\n              this.$Message.success(res.msg);\n              this.$router.push({ path: \"/admin/product/specs\" });\n            })\n            .catch((err) => {\n              this.$Message.error(err.msg);\n            });\n        } else {\n          this.$Message.error(\"请输入参数模板名称\");\n        }\n      });\n    },\n  },\n};\n",null]}