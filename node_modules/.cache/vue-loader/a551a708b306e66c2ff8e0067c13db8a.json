{"remainingRequest":"/home/darkcrossunicorn/文档/admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/darkcrossunicorn/文档/admin/node_modules/iview-loader/index.js??ref--0-2!/home/darkcrossunicorn/文档/admin/src/pages/system/maintain/systemFile/opendir.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/darkcrossunicorn/文档/admin/src/pages/system/maintain/systemFile/opendir.vue","mtime":1640264908000},{"path":"/home/darkcrossunicorn/文档/admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/darkcrossunicorn/文档/admin/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/darkcrossunicorn/文档/admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/darkcrossunicorn/文档/admin/node_modules/vue-loader/lib/index.js","mtime":499162500000},{"path":"/home/darkcrossunicorn/文档/admin/node_modules/iview-loader/index.js","mtime":1570440814000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { opendirListApi, openfileApi, savefileApi } from '@/api/system';\nimport CodeMirror from 'codemirror/lib/codemirror'\nimport 'codemirror/theme/ambiance.css';\nrequire('codemirror/mode/javascript/javascript');\nexport default {\n    name: 'opendir',\n    data () {\n        return {\n            code: '',\n            modals: false,\n            spinShow: false,\n            loading: false,\n            tabList: [],\n            columns4: [\n                {\n                    title: '文件/文件夹名',\n                    slot: 'filename',\n                    minWidth: 150,\n                    back: '返回上级'\n                },\n                {\n                    title: '文件/文件夹路径',\n                    key: 'real_path',\n                    minWidth: 150\n                },\n                {\n                    title: '文件/文件夹大小',\n                    key: 'size',\n                    minWidth: 100\n                },\n                {\n                    title: '是否可写',\n                    slot: 'isWritable',\n                    minWidth: 100\n                },\n                {\n                    title: '更新时间',\n                    key: 'mtime',\n                    minWidth: 150\n                },\n                {\n                    title: 'Action',\n                    slot: 'action',\n                    minWidth: 150\n                }\n            ],\n            formItem: {\n                dir: '',\n                superior: 0,\n                filedir: ''\n            },\n            rows: {},\n            pathname: '',\n            title: ''\n        }\n    },\n    mounted () {\n        this.editor = CodeMirror.fromTextArea(this.$refs.mycode, {\n            value: 'http://www.crmeb.com', // 文本域默认显示的文本\n            mode: 'text/javascript',\n            theme: 'ambiance', // CSS样式选择\n            indentUnit: 4, // 缩进单位，默认2\n            smartIndent: true, // 是否智能缩进\n            tabSize: 4, // Tab缩进，默认4\n            readOnly: false, // 是否只读，默认false\n            showCursorWhenSelecting: true,\n            lineNumbers: true // 是否显示行号\n        })\n    },\n    created () {\n        this.getList();\n    },\n    methods: {\n        // 点击行\n        currentChange (currentRow) {\n            if (currentRow.isDir) {\n                this.open(currentRow);\n            } else {\n                this.edit(currentRow);\n            }\n        },\n        // 列表\n        getList () {\n            this.loading = true;\n            opendirListApi(this.formItem).then(async res => {\n                let data = res.data\n                this.tabList = data.list;\n                this.dir = data.dir;\n                this.loading = false;\n            }).catch(res => {\n                this.loading = false;\n                this.$Message.error(res.msg);\n            })\n        },\n        // 返回上级\n        goBack () {\n            this.formItem = {\n                dir: this.dir,\n                superior: 1,\n                filedir: ''\n            }\n            this.getList()\n        },\n        // 打开\n        open (row) {\n            this.rows = row;\n            this.formItem = {\n                dir: row.path,\n                superior: 0,\n                filedir: row.filename\n            }\n            this.getList()\n        },\n        // 编辑\n        edit (row) {\n            this.modals = true;\n            this.spinShow = true;\n            this.pathname = row.pathname;\n            this.title = row.filename;\n            openfileApi(row.pathname).then(async res => {\n                let data = res.data;\n                this.code = data.content;\n                this.editor.setValue(this.code);\n                this.spinShow = false;\n            }).catch(res => {\n                this.spinShow = false;\n                this.$Message.error(res.msg);\n            })\n        },\n        // 保存\n        savefile () {\n            let data = {\n                comment: this.editor.getValue(),\n                filepath: this.pathname\n            };\n            savefileApi(data).then(async res => {\n                this.$Message.success(res.msg);\n                this.modals = false;\n            }).catch(res => {\n                this.$Message.error(res.msg);\n            })\n        },\n        // 撤销\n        undofile () {\n            this.editor.undo();\n        },\n        redofile () {\n            this.editor.redo();\n        },\n        // 刷新\n        refreshfile () {\n            this.editor.refresh();\n        }\n    }\n}\n",null]}