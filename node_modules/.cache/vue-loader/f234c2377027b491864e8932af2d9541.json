{"remainingRequest":"/home/darkcrossunicorn/文档/admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/darkcrossunicorn/文档/admin/node_modules/iview-loader/index.js??ref--0-2!/home/darkcrossunicorn/文档/admin/src/pages/work/staffList/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/darkcrossunicorn/文档/admin/src/pages/work/staffList/index.vue","mtime":1658973957000},{"path":"/home/darkcrossunicorn/文档/admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/darkcrossunicorn/文档/admin/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/darkcrossunicorn/文档/admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/darkcrossunicorn/文档/admin/node_modules/vue-loader/lib/index.js","mtime":499162500000},{"path":"/home/darkcrossunicorn/文档/admin/node_modules/iview-loader/index.js","mtime":1570440814000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { mapState } from \"vuex\";\nimport { workDepartment, workMember } from \"@/api/work\";\nimport sideMenuItem from \"./menuChild.vue\";\nimport { workSynchMember } from \"@/api/work\";\nexport default {\n  name: \"\",\n  data() {\n    return {\n      activeName: 1,\n      menuList: [],\n      tableFrom: {\n        department: \"\",\n        name: \"\",\n        page: 1,\n        limit: 15,\n      },\n      loading: false,\n      columns1: [\n        {\n          title: \"ID\",\n          key: \"id\",\n          minWidth: 60,\n        },\n        {\n          title: \"员工头像\",\n          slot: \"avatar\",\n          minWidth: 60,\n        },\n        {\n          title: \"员工名称\",\n          key: \"name\",\n          minWidth: 100,\n        },\n        {\n          title: \"所属部门\",\n          slot: \"department_list\",\n          minWidth: 140,\n        },\n        {\n          title: \"客户数量\",\n          slot: \"clientFollow\",\n          minWidth: 110,\n        },\n        {\n          title: \"所在外部群数量\",\n          slot: \"chat\",\n          minWidth: 110,\n        },\n\n        {\n          title: \"手机号\",\n          key: \"mobile\",\n          minWidth: 110,\n        },\n        {\n          title: \"邮箱\",\n          key: \"biz_mail\",\n          minWidth: 130,\n        },\n        {\n          title: \"激活状态\",\n          slot: \"status\",\n          minWidth: 60,\n        },\n        {\n          title: \"创建时间\",\n          key: \"create_time\",\n          minWidth: 110,\n        },\n      ],\n      tableData: [],\n      openMenu: [],\n    };\n  },\n  components: {\n    sideMenuItem,\n  },\n  computed: {\n    ...mapState(\"admin/layout\", [\"isMobile\"]),\n    labelWidth() {\n      return this.isMobile ? undefined : 80;\n    },\n    labelPosition() {\n      return this.isMobile ? \"top\" : \"left\";\n    },\n  },\n  filters: {\n    typeFilter(status) {\n      const statusMap = {\n        1: \"已激活\",\n        2: \"已禁用\",\n        4: \"未激活\",\n        5: \"退出企业\",\n      };\n      return statusMap[status];\n    },\n  },\n  created() {\n    this.getWorkTree();\n    this.getMemberList();\n  },\n  methods: {\n    synchMember() {\n      workSynchMember()\n        .then((res) => {\n          this.$Message.success(\"同步成功\");\n        })\n        .catch((err) => {\n          this.$Message.error(err.msg);\n        });\n    },\n    getMemberList() {\n      this.loading = true;\n      workMember(this.tableFrom)\n        .then((res) => {\n          this.tableData = res.data;\n          this.loading = false;\n        })\n        .catch((err) => {\n          this.$Message.error(err.msg);\n          this.loading = false;\n        });\n    },\n    search() {\n      this.tableFrom.page = 1;\n      this.getMemberList();\n    },\n    setDefault() {\n      this.tableFrom.page = 1;\n      this.tableFrom.department = \"\";\n      this.tableFrom.name = \"\";\n      this.getMemberList();\n    },\n    onOpenChange(name) {\n      if (!name.length) {\n        this.tableFrom.department = \"\";\n        this.tableFrom.page = 1;\n        this.getMemberList();\n      } else {\n        this.$nextTick(() => {\n          this.tableFrom.department =\n            this.activeName == 1 ? \"\" : this.activeName;\n          this.getMemberList();\n        });\n      }\n    },\n    onselect(name) {\n      this.activeName = name;\n      this.tableFrom.department = name;\n      this.tableFrom.page = 1;\n      this.getMemberList();\n    },\n    getWorkTree() {\n      workDepartment().then((res) => {\n        // let obj = {\n        //     name: \"全部\",\n        //     department_id: \"\",\n        //     parentid: 1\n        // };\n        // res.data[0].children.unshift(obj);\n        this.menuList = res.data;\n        this.activeName == res.data[0].department_id;\n        this.getTreeId(this.menuList);\n        this.$nextTick(() => {\n          this.$refs.side_menu.updateOpened();\n          this.$refs.side_menu.updateActiveName();\n        });\n      });\n    },\n    getTreeId(datas) {\n      for (var i in datas) {\n        this.openMenu.push(datas[i].department_id);\n        if (datas[i].children) {\n          this.getTreeId(datas[i].children);\n        }\n      }\n    },\n    pageChange(index) {\n      this.tableFrom.page = index;\n      this.getMemberList();\n    },\n  },\n};\n",null]}