{"remainingRequest":"/home/darkcrossunicorn/文档/admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/darkcrossunicorn/文档/admin/node_modules/iview-loader/index.js??ref--0-2!/home/darkcrossunicorn/文档/admin/src/pages/notify/smsConfig/components/register.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/darkcrossunicorn/文档/admin/src/pages/notify/smsConfig/components/register.vue","mtime":1648430075000},{"path":"/home/darkcrossunicorn/文档/admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/darkcrossunicorn/文档/admin/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/darkcrossunicorn/文档/admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/darkcrossunicorn/文档/admin/node_modules/vue-loader/lib/index.js","mtime":499162500000},{"path":"/home/darkcrossunicorn/文档/admin/node_modules/iview-loader/index.js","mtime":1570440814000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport Vcode from \"vue-puzzle-vcode\";\nimport { captchaApi, registerApi } from '@/api/setting';\nexport default {\n    name: 'register',\n    data () {\n        const validatePhone = (rule, value, callback) => {\n            if (!value) {\n                return callback(new Error('请填写手机号'));\n            } else if (!/^1[3456789]\\d{9}$/.test(value)) {\n                callback(new Error('手机号格式不正确!'));\n            } else {\n                callback();\n            }\n        };\n        return {\n            cutNUm: '获取验证码',\n            canClick: true,\n            formInline: {\n                url: '',\n                password: '',\n                verify_code: '',\n                phone: ''\n            },\n            ruleInline: {\n                account: [\n                    { required: true, message: '请输入短信平台账号', trigger: 'blur' }\n                ],\n                password: [\n                    { required: true, message: '请输入短信平台密码/token', trigger: 'blur' }\n                ],\n                url: [\n                    { required: true, message: '请输入网址域名', trigger: 'blur' }\n                ],\n                phone: [\n                    { required: true, validator: validatePhone, trigger: 'blur' }\n                ],\n                sign: [\n                    { required: true, message: '请输入短信签名', trigger: 'blur' }\n                ],\n                verify_code: [\n                    { required: true, message: '请输入验证码', trigger: 'blur' }\n                ]\n            },\n            isShow: false, // 验证码模态框是否出现\n        }\n    },\n    components:{\n        Vcode\n    },\n    methods: {\n        // 短信验证码\n        cutDown () {\n            if (this.formInline.phone) {\n                this.isShow = true;\n            } else {\n                this.$Message.warning('请填写手机号!');\n            }\n        },\n        // 注册\n        handleSubmit (name) {\n            this.$refs[name].validate((valid) => {\n                if (valid) {\n                    registerApi(this.formInline).then(async res => {\n                        this.$Message.success(res.msg);\n                        setTimeout(() => {\n                            this.changelogo();\n                        }, 1000);\n                    }).catch(res => {\n                        this.$Message.error(res.msg);\n                    })\n                } else {\n                    return false;\n                }\n            })\n        },\n        // 立即登录\n        changelogo () {\n            this.$emit('on-change')\n        },\n        onSuccess(){\n            this.isShow = false; // 通过验证后，需要手动隐藏模态框\n            if (!this.canClick) return;\n            this.canClick = false;\n            this.cutNUm = 60;\n            let data = {\n                phone: this.formInline.phone\n            };\n            captchaApi(data).then(async res => {\n                this.$Message.success(res.msg);\n            }).catch(res => {\n                this.$Message.error(res.msg);\n            })\n            let time = setInterval(() => {\n                this.cutNUm--;\n                if (this.cutNUm === 0) {\n                    this.cutNUm = '获取验证码';\n                    this.canClick = true;\n                    clearInterval(time)\n                }\n            }, 1000)\n        },\n        // 用户点击遮罩层，应该关闭模态框\n        onClose(){\n            this.isShow = false;\n        }\n    }\n}\n",null]}